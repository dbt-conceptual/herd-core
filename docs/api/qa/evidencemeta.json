{"queries":[{"id":"qa_overview","compiledQueryString":"SELECT\n    COUNT(DISTINCT frq.review_submission_tk) as total_reviews,\n    SUM(CASE WHEN frq.review_round = 1 THEN 1 ELSE 0 END) as first_round_reviews,\n    SUM(CASE WHEN frq.review_round = 1 AND frq.review_verdict = 'approved' THEN 1 ELSE 0 END) as first_pass_approvals,\n    ROUND(100.0 * SUM(CASE WHEN frq.review_round = 1 AND frq.review_verdict = 'approved' THEN 1 ELSE 0 END) / NULLIF(SUM(CASE WHEN frq.review_round = 1 THEN 1 ELSE 0 END), 0), 1) as first_pass_rate,\n    SUM(frq.finding_count) as total_findings,\n    SUM(frq.blocking_finding_count) as blocking_findings,\n    SUM(frq.advisory_finding_count) as advisory_findings,\n    ROUND(AVG(frq.review_duration_minutes), 1) as avg_review_minutes\nFROM herd.fact_review_quality frq","inputQueryString":"SELECT\n    COUNT(DISTINCT frq.review_submission_tk) as total_reviews,\n    SUM(CASE WHEN frq.review_round = 1 THEN 1 ELSE 0 END) as first_round_reviews,\n    SUM(CASE WHEN frq.review_round = 1 AND frq.review_verdict = 'approved' THEN 1 ELSE 0 END) as first_pass_approvals,\n    ROUND(100.0 * SUM(CASE WHEN frq.review_round = 1 AND frq.review_verdict = 'approved' THEN 1 ELSE 0 END) / NULLIF(SUM(CASE WHEN frq.review_round = 1 THEN 1 ELSE 0 END), 0), 1) as first_pass_rate,\n    SUM(frq.finding_count) as total_findings,\n    SUM(frq.blocking_finding_count) as blocking_findings,\n    SUM(frq.advisory_finding_count) as advisory_findings,\n    ROUND(AVG(frq.review_duration_minutes), 1) as avg_review_minutes\nFROM herd.fact_review_quality frq","compiled":false,"inline":true},{"id":"first_pass_trend","compiledQueryString":"SELECT\n    dd.date_actual as date,\n    COUNT(DISTINCT frq.review_submission_tk) as reviews,\n    SUM(CASE WHEN frq.review_round = 1 AND frq.review_verdict = 'approved' THEN 1 ELSE 0 END) as approvals,\n    ROUND(100.0 * SUM(CASE WHEN frq.review_round = 1 AND frq.review_verdict = 'approved' THEN 1 ELSE 0 END) / NULLIF(COUNT(DISTINCT frq.review_submission_tk), 0), 1) as first_pass_rate\nFROM herd.dim_date dd\nLEFT JOIN herd.fact_review_quality frq\n    ON CAST(strftime(frq.review_completed_at, '%Y%m%d') AS INTEGER) = dd.date_sk\n    AND frq.review_round = 1\nWHERE dd.date_actual >= CURRENT_DATE - INTERVAL '30 days'\n  AND dd.date_actual <= CURRENT_DATE\nGROUP BY dd.date_actual\nORDER BY dd.date_actual","inputQueryString":"SELECT\n    dd.date_actual as date,\n    COUNT(DISTINCT frq.review_submission_tk) as reviews,\n    SUM(CASE WHEN frq.review_round = 1 AND frq.review_verdict = 'approved' THEN 1 ELSE 0 END) as approvals,\n    ROUND(100.0 * SUM(CASE WHEN frq.review_round = 1 AND frq.review_verdict = 'approved' THEN 1 ELSE 0 END) / NULLIF(COUNT(DISTINCT frq.review_submission_tk), 0), 1) as first_pass_rate\nFROM herd.dim_date dd\nLEFT JOIN herd.fact_review_quality frq\n    ON CAST(strftime(frq.review_completed_at, '%Y%m%d') AS INTEGER) = dd.date_sk\n    AND frq.review_round = 1\nWHERE dd.date_actual >= CURRENT_DATE - INTERVAL '30 days'\n  AND dd.date_actual <= CURRENT_DATE\nGROUP BY dd.date_actual\nORDER BY dd.date_actual","compiled":false,"inline":true},{"id":"findings_by_category","compiledQueryString":"SELECT\n    CASE\n        WHEN frq.blocking_finding_count > 0 THEN 'Blocking'\n        WHEN frq.advisory_finding_count > 0 THEN 'Advisory'\n        ELSE 'Clean'\n    END as finding_category,\n    COUNT(DISTINCT frq.review_submission_tk) as review_count,\n    SUM(frq.finding_count) as total_findings\nFROM herd.fact_review_quality frq\nGROUP BY finding_category\nORDER BY review_count DESC","inputQueryString":"SELECT\n    CASE\n        WHEN frq.blocking_finding_count > 0 THEN 'Blocking'\n        WHEN frq.advisory_finding_count > 0 THEN 'Advisory'\n        ELSE 'Clean'\n    END as finding_category,\n    COUNT(DISTINCT frq.review_submission_tk) as review_count,\n    SUM(frq.finding_count) as total_findings\nFROM herd.fact_review_quality frq\nGROUP BY finding_category\nORDER BY review_count DESC","compiled":false,"inline":true},{"id":"findings_by_agent","compiledQueryString":"SELECT\n    da.agent_code,\n    da.agent_role,\n    COUNT(DISTINCT frq.review_submission_tk) as reviews,\n    SUM(frq.finding_count) as total_findings,\n    SUM(frq.blocking_finding_count) as blocking_findings,\n    SUM(frq.advisory_finding_count) as advisory_findings,\n    ROUND(AVG(frq.finding_count), 1) as avg_findings_per_review\nFROM herd.fact_review_quality frq\nJOIN herd.dim_agent da\n    ON frq.agent_sk = da.agent_sk\nWHERE da.is_current = true\n  AND NOT da.is_deleted\nGROUP BY da.agent_code, da.agent_role\nORDER BY total_findings DESC","inputQueryString":"SELECT\n    da.agent_code,\n    da.agent_role,\n    COUNT(DISTINCT frq.review_submission_tk) as reviews,\n    SUM(frq.finding_count) as total_findings,\n    SUM(frq.blocking_finding_count) as blocking_findings,\n    SUM(frq.advisory_finding_count) as advisory_findings,\n    ROUND(AVG(frq.finding_count), 1) as avg_findings_per_review\nFROM herd.fact_review_quality frq\nJOIN herd.dim_agent da\n    ON frq.agent_sk = da.agent_sk\nWHERE da.is_current = true\n  AND NOT da.is_deleted\nGROUP BY da.agent_code, da.agent_role\nORDER BY total_findings DESC","compiled":false,"inline":true},{"id":"review_rounds","compiledQueryString":"SELECT\n    frq.review_round,\n    COUNT(DISTINCT frq.review_submission_tk) as review_count,\n    SUM(CASE WHEN frq.review_verdict = 'approved' THEN 1 ELSE 0 END) as approved_count,\n    ROUND(100.0 * SUM(CASE WHEN frq.review_verdict = 'approved' THEN 1 ELSE 0 END) / COUNT(DISTINCT frq.review_submission_tk), 1) as approval_rate\nFROM herd.fact_review_quality frq\nGROUP BY frq.review_round\nORDER BY frq.review_round","inputQueryString":"SELECT\n    frq.review_round,\n    COUNT(DISTINCT frq.review_submission_tk) as review_count,\n    SUM(CASE WHEN frq.review_verdict = 'approved' THEN 1 ELSE 0 END) as approved_count,\n    ROUND(100.0 * SUM(CASE WHEN frq.review_verdict = 'approved' THEN 1 ELSE 0 END) / COUNT(DISTINCT frq.review_submission_tk), 1) as approval_rate\nFROM herd.fact_review_quality frq\nGROUP BY frq.review_round\nORDER BY frq.review_round","compiled":false,"inline":true},{"id":"rework_cost","compiledQueryString":"SELECT\n    dt.ticket_code,\n    dt.ticket_title,\n    COUNT(DISTINCT frq.review_submission_tk) as review_attempts,\n    MAX(frq.review_round) as max_rounds,\n    SUM(faic.total_token_cost_usd) as total_cost,\n    SUM(CASE WHEN frq.review_round > 1 THEN faic.total_token_cost_usd ELSE 0 END) as rework_cost,\n    ROUND(100.0 * SUM(CASE WHEN frq.review_round > 1 THEN faic.total_token_cost_usd ELSE 0 END) / NULLIF(SUM(faic.total_token_cost_usd), 0), 1) as rework_cost_pct\nFROM herd.dim_ticket dt\nJOIN herd.fact_agent_instance_cost faic\n    ON dt.ticket_sk = faic.ticket_sk\nLEFT JOIN herd.fact_pr_delivery fpd\n    ON dt.ticket_sk = fpd.ticket_sk\nLEFT JOIN herd.fact_review_quality frq\n    ON fpd.pull_request_sk = frq.pull_request_sk\nWHERE dt.is_current = true\n  AND NOT dt.is_deleted\n  AND faic.total_token_cost_usd > 0\nGROUP BY dt.ticket_code, dt.ticket_title\nHAVING COUNT(DISTINCT frq.review_submission_tk) > 1\nORDER BY rework_cost DESC\nLIMIT 20","inputQueryString":"SELECT\n    dt.ticket_code,\n    dt.ticket_title,\n    COUNT(DISTINCT frq.review_submission_tk) as review_attempts,\n    MAX(frq.review_round) as max_rounds,\n    SUM(faic.total_token_cost_usd) as total_cost,\n    SUM(CASE WHEN frq.review_round > 1 THEN faic.total_token_cost_usd ELSE 0 END) as rework_cost,\n    ROUND(100.0 * SUM(CASE WHEN frq.review_round > 1 THEN faic.total_token_cost_usd ELSE 0 END) / NULLIF(SUM(faic.total_token_cost_usd), 0), 1) as rework_cost_pct\nFROM herd.dim_ticket dt\nJOIN herd.fact_agent_instance_cost faic\n    ON dt.ticket_sk = faic.ticket_sk\nLEFT JOIN herd.fact_pr_delivery fpd\n    ON dt.ticket_sk = fpd.ticket_sk\nLEFT JOIN herd.fact_review_quality frq\n    ON fpd.pull_request_sk = frq.pull_request_sk\nWHERE dt.is_current = true\n  AND NOT dt.is_deleted\n  AND faic.total_token_cost_usd > 0\nGROUP BY dt.ticket_code, dt.ticket_title\nHAVING COUNT(DISTINCT frq.review_submission_tk) > 1\nORDER BY rework_cost DESC\nLIMIT 20","compiled":false,"inline":true},{"id":"review_duration","compiledQueryString":"SELECT\n    frq.review_duration_minutes as duration,\n    COUNT(*) as count\nFROM herd.fact_review_quality frq\nWHERE frq.review_duration_minutes IS NOT NULL","inputQueryString":"SELECT\n    frq.review_duration_minutes as duration,\n    COUNT(*) as count\nFROM herd.fact_review_quality frq\nWHERE frq.review_duration_minutes IS NOT NULL","compiled":false,"inline":true}]}