{"queries":[{"id":"pipeline_summary","compiledQueryString":"SELECT\n    COUNT(DISTINCT dt.ticket_tk) as active_tickets,\n    COUNT(DISTINCT CASE WHEN dt.ticket_current_status = 'Backlog' THEN dt.ticket_tk END) as backlog_tickets,\n    COUNT(DISTINCT CASE WHEN dt.ticket_current_status = 'In Progress' THEN dt.ticket_tk END) as in_progress_tickets,\n    COUNT(DISTINCT CASE WHEN dt.ticket_current_status IN ('PR Submitted', 'QA Review') THEN dt.ticket_tk END) as review_tickets,\n    COUNT(DISTINCT CASE WHEN ftl.blocker_ticket_code IS NOT NULL THEN dt.ticket_tk END) as blocked_tickets\nFROM herd.dim_ticket dt\nLEFT JOIN herd.fact_ticket_lifecycle ftl\n    ON dt.ticket_sk = ftl.ticket_sk\nWHERE dt.is_current = true\n  AND NOT dt.is_deleted\n  AND dt.ticket_current_status NOT IN ('Done', 'Canceled', 'Cancelled', 'Archived')","inputQueryString":"SELECT\n    COUNT(DISTINCT dt.ticket_tk) as active_tickets,\n    COUNT(DISTINCT CASE WHEN dt.ticket_current_status = 'Backlog' THEN dt.ticket_tk END) as backlog_tickets,\n    COUNT(DISTINCT CASE WHEN dt.ticket_current_status = 'In Progress' THEN dt.ticket_tk END) as in_progress_tickets,\n    COUNT(DISTINCT CASE WHEN dt.ticket_current_status IN ('PR Submitted', 'QA Review') THEN dt.ticket_tk END) as review_tickets,\n    COUNT(DISTINCT CASE WHEN ftl.blocker_ticket_code IS NOT NULL THEN dt.ticket_tk END) as blocked_tickets\nFROM herd.dim_ticket dt\nLEFT JOIN herd.fact_ticket_lifecycle ftl\n    ON dt.ticket_sk = ftl.ticket_sk\nWHERE dt.is_current = true\n  AND NOT dt.is_deleted\n  AND dt.ticket_current_status NOT IN ('Done', 'Canceled', 'Cancelled', 'Archived')","compiled":false,"inline":true},{"id":"time_in_status","compiledQueryString":"SELECT\n    ftl.previous_status,\n    COUNT(*) as transition_count,\n    ROUND(AVG(ftl.time_in_previous_status_minutes), 1) as avg_minutes,\n    ROUND(MIN(ftl.time_in_previous_status_minutes), 1) as min_minutes,\n    ROUND(MAX(ftl.time_in_previous_status_minutes), 1) as max_minutes,\n    ROUND(MEDIAN(ftl.time_in_previous_status_minutes), 1) as median_minutes\nFROM herd.fact_ticket_lifecycle ftl\nWHERE ftl.time_in_previous_status_minutes IS NOT NULL\n  AND ftl.previous_status IS NOT NULL\nGROUP BY ftl.previous_status\nORDER BY avg_minutes DESC","inputQueryString":"SELECT\n    ftl.previous_status,\n    COUNT(*) as transition_count,\n    ROUND(AVG(ftl.time_in_previous_status_minutes), 1) as avg_minutes,\n    ROUND(MIN(ftl.time_in_previous_status_minutes), 1) as min_minutes,\n    ROUND(MAX(ftl.time_in_previous_status_minutes), 1) as max_minutes,\n    ROUND(MEDIAN(ftl.time_in_previous_status_minutes), 1) as median_minutes\nFROM herd.fact_ticket_lifecycle ftl\nWHERE ftl.time_in_previous_status_minutes IS NOT NULL\n  AND ftl.previous_status IS NOT NULL\nGROUP BY ftl.previous_status\nORDER BY avg_minutes DESC","compiled":false,"inline":true},{"id":"handoff_latency","compiledQueryString":"SELECT\n    CONCAT(ftl.previous_status, ' → ', ftl.ticket_status) as transition,\n    COUNT(*) as count,\n    ROUND(AVG(ftl.time_in_previous_status_minutes / 60.0), 1) as avg_hours,\n    ROUND(MEDIAN(ftl.time_in_previous_status_minutes / 60.0), 1) as median_hours\nFROM herd.fact_ticket_lifecycle ftl\nWHERE ftl.time_in_previous_status_minutes IS NOT NULL\n  AND ftl.previous_status IS NOT NULL\n  AND ftl.ticket_status != ftl.previous_status\nGROUP BY transition\nORDER BY avg_hours DESC\nLIMIT 20","inputQueryString":"SELECT\n    CONCAT(ftl.previous_status, ' → ', ftl.ticket_status) as transition,\n    COUNT(*) as count,\n    ROUND(AVG(ftl.time_in_previous_status_minutes / 60.0), 1) as avg_hours,\n    ROUND(MEDIAN(ftl.time_in_previous_status_minutes / 60.0), 1) as median_hours\nFROM herd.fact_ticket_lifecycle ftl\nWHERE ftl.time_in_previous_status_minutes IS NOT NULL\n  AND ftl.previous_status IS NOT NULL\n  AND ftl.ticket_status != ftl.previous_status\nGROUP BY transition\nORDER BY avg_hours DESC\nLIMIT 20","compiled":false,"inline":true},{"id":"blocked_tickets","compiledQueryString":"SELECT\n    dt.ticket_code,\n    dt.ticket_title,\n    dt.ticket_current_status,\n    ftl.blocker_ticket_code,\n    da.agent_code as assigned_agent,\n    ftl.event_ts as blocked_since\nFROM herd.fact_ticket_lifecycle ftl\nJOIN herd.dim_ticket dt\n    ON ftl.ticket_sk = dt.ticket_sk\nLEFT JOIN herd.dim_agent da\n    ON ftl.agent_sk = da.agent_sk\nWHERE ftl.blocker_ticket_code IS NOT NULL\n  AND dt.is_current = true\n  AND NOT dt.is_deleted\nORDER BY ftl.event_ts DESC","inputQueryString":"SELECT\n    dt.ticket_code,\n    dt.ticket_title,\n    dt.ticket_current_status,\n    ftl.blocker_ticket_code,\n    da.agent_code as assigned_agent,\n    ftl.event_ts as blocked_since\nFROM herd.fact_ticket_lifecycle ftl\nJOIN herd.dim_ticket dt\n    ON ftl.ticket_sk = dt.ticket_sk\nLEFT JOIN herd.dim_agent da\n    ON ftl.agent_sk = da.agent_sk\nWHERE ftl.blocker_ticket_code IS NOT NULL\n  AND dt.is_current = true\n  AND NOT dt.is_deleted\nORDER BY ftl.event_ts DESC","compiled":false,"inline":true},{"id":"ticket_flow","compiledQueryString":"SELECT\n    dd.date_actual as date,\n    COUNT(DISTINCT CASE WHEN ftl.ticket_event_type = 'created' THEN ftl.ticket_code END) as created,\n    COUNT(DISTINCT CASE WHEN ftl.ticket_event_type = 'started' THEN ftl.ticket_code END) as started,\n    COUNT(DISTINCT CASE WHEN ftl.ticket_event_type = 'completed' THEN ftl.ticket_code END) as completed\nFROM herd.dim_date dd\nLEFT JOIN herd.fact_ticket_lifecycle ftl\n    ON CAST(strftime(ftl.event_ts, '%Y%m%d') AS INTEGER) = dd.date_sk\nWHERE dd.date_actual >= CURRENT_DATE - INTERVAL '30 days'\n  AND dd.date_actual <= CURRENT_DATE\nGROUP BY dd.date_actual\nORDER BY dd.date_actual","inputQueryString":"SELECT\n    dd.date_actual as date,\n    COUNT(DISTINCT CASE WHEN ftl.ticket_event_type = 'created' THEN ftl.ticket_code END) as created,\n    COUNT(DISTINCT CASE WHEN ftl.ticket_event_type = 'started' THEN ftl.ticket_code END) as started,\n    COUNT(DISTINCT CASE WHEN ftl.ticket_event_type = 'completed' THEN ftl.ticket_code END) as completed\nFROM herd.dim_date dd\nLEFT JOIN herd.fact_ticket_lifecycle ftl\n    ON CAST(strftime(ftl.event_ts, '%Y%m%d') AS INTEGER) = dd.date_sk\nWHERE dd.date_actual >= CURRENT_DATE - INTERVAL '30 days'\n  AND dd.date_actual <= CURRENT_DATE\nGROUP BY dd.date_actual\nORDER BY dd.date_actual","compiled":false,"inline":true},{"id":"cycle_time_by_size","compiledQueryString":"WITH ticket_cycle_time AS (\n    SELECT\n        dt.ticket_tk,\n        dt.ticket_code,\n        dt.ticket_tshirt_size,\n        MIN(CASE WHEN ftl.ticket_event_type = 'started' THEN ftl.event_ts END) as started_at,\n        MAX(CASE WHEN ftl.ticket_event_type = 'completed' THEN ftl.event_ts END) as completed_at\n    FROM herd.dim_ticket dt\n    JOIN herd.fact_ticket_lifecycle ftl\n        ON dt.ticket_sk = ftl.ticket_sk\n    WHERE dt.is_current = true\n      AND NOT dt.is_deleted\n    GROUP BY dt.ticket_tk, dt.ticket_code, dt.ticket_tshirt_size\n    HAVING started_at IS NOT NULL AND completed_at IS NOT NULL\n)\nSELECT\n    ticket_tshirt_size,\n    COUNT(*) as ticket_count,\n    ROUND(AVG(EXTRACT(EPOCH FROM (completed_at - started_at)) / 3600.0), 1) as avg_cycle_hours,\n    ROUND(MEDIAN(EXTRACT(EPOCH FROM (completed_at - started_at)) / 3600.0), 1) as median_cycle_hours\nFROM ticket_cycle_time\nWHERE ticket_tshirt_size IS NOT NULL\nGROUP BY ticket_tshirt_size\nORDER BY\n    CASE ticket_tshirt_size\n        WHEN 'XS' THEN 1\n        WHEN 'S' THEN 2\n        WHEN 'M' THEN 3\n        WHEN 'L' THEN 4\n        WHEN 'XL' THEN 5\n        ELSE 6\n    END","inputQueryString":"WITH ticket_cycle_time AS (\n    SELECT\n        dt.ticket_tk,\n        dt.ticket_code,\n        dt.ticket_tshirt_size,\n        MIN(CASE WHEN ftl.ticket_event_type = 'started' THEN ftl.event_ts END) as started_at,\n        MAX(CASE WHEN ftl.ticket_event_type = 'completed' THEN ftl.event_ts END) as completed_at\n    FROM herd.dim_ticket dt\n    JOIN herd.fact_ticket_lifecycle ftl\n        ON dt.ticket_sk = ftl.ticket_sk\n    WHERE dt.is_current = true\n      AND NOT dt.is_deleted\n    GROUP BY dt.ticket_tk, dt.ticket_code, dt.ticket_tshirt_size\n    HAVING started_at IS NOT NULL AND completed_at IS NOT NULL\n)\nSELECT\n    ticket_tshirt_size,\n    COUNT(*) as ticket_count,\n    ROUND(AVG(EXTRACT(EPOCH FROM (completed_at - started_at)) / 3600.0), 1) as avg_cycle_hours,\n    ROUND(MEDIAN(EXTRACT(EPOCH FROM (completed_at - started_at)) / 3600.0), 1) as median_cycle_hours\nFROM ticket_cycle_time\nWHERE ticket_tshirt_size IS NOT NULL\nGROUP BY ticket_tshirt_size\nORDER BY\n    CASE ticket_tshirt_size\n        WHEN 'XS' THEN 1\n        WHEN 'S' THEN 2\n        WHEN 'M' THEN 3\n        WHEN 'L' THEN 4\n        WHEN 'XL' THEN 5\n        ELSE 6\n    END","compiled":false,"inline":true},{"id":"longest_in_progress","compiledQueryString":"WITH ticket_start_times AS (\n    SELECT\n        dt.ticket_code,\n        dt.ticket_title,\n        dt.ticket_current_status,\n        dt.ticket_tshirt_size,\n        da.agent_code as assigned_agent,\n        MIN(ftl.event_ts) as started_at\n    FROM herd.dim_ticket dt\n    JOIN herd.fact_ticket_lifecycle ftl\n        ON dt.ticket_sk = ftl.ticket_sk\n    LEFT JOIN herd.dim_agent da\n        ON ftl.agent_sk = da.agent_sk\n    WHERE dt.is_current = true\n      AND NOT dt.is_deleted\n      AND dt.ticket_current_status IN ('In Progress', 'PR Submitted', 'QA Review', 'Assigned')\n      AND ftl.ticket_status IN ('In Progress', 'PR Submitted', 'QA Review', 'Assigned')\n    GROUP BY dt.ticket_code, dt.ticket_title, dt.ticket_current_status, dt.ticket_tshirt_size, da.agent_code\n)\nSELECT\n    ticket_code,\n    ticket_title,\n    ticket_current_status,\n    ticket_tshirt_size,\n    assigned_agent,\n    started_at,\n    ROUND(EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - started_at)) / 3600.0, 1) as hours_in_progress\nFROM ticket_start_times\nORDER BY hours_in_progress DESC\nLIMIT 20","inputQueryString":"WITH ticket_start_times AS (\n    SELECT\n        dt.ticket_code,\n        dt.ticket_title,\n        dt.ticket_current_status,\n        dt.ticket_tshirt_size,\n        da.agent_code as assigned_agent,\n        MIN(ftl.event_ts) as started_at\n    FROM herd.dim_ticket dt\n    JOIN herd.fact_ticket_lifecycle ftl\n        ON dt.ticket_sk = ftl.ticket_sk\n    LEFT JOIN herd.dim_agent da\n        ON ftl.agent_sk = da.agent_sk\n    WHERE dt.is_current = true\n      AND NOT dt.is_deleted\n      AND dt.ticket_current_status IN ('In Progress', 'PR Submitted', 'QA Review', 'Assigned')\n      AND ftl.ticket_status IN ('In Progress', 'PR Submitted', 'QA Review', 'Assigned')\n    GROUP BY dt.ticket_code, dt.ticket_title, dt.ticket_current_status, dt.ticket_tshirt_size, da.agent_code\n)\nSELECT\n    ticket_code,\n    ticket_title,\n    ticket_current_status,\n    ticket_tshirt_size,\n    assigned_agent,\n    started_at,\n    ROUND(EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - started_at)) / 3600.0, 1) as hours_in_progress\nFROM ticket_start_times\nORDER BY hours_in_progress DESC\nLIMIT 20","compiled":false,"inline":true}]}